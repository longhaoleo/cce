### **基于因果扰动定位与抑制的组合概念解耦擦除**



关于组合概念擦除问题，现有一篇文章——Erasing concept combination from text-to-image diffusion model，提出CCE问题并给出方法COGFD。

COGFD如何做的：

1. 组合分解：先把提示词/主题拆成“概念组合图”（论文用 LLM 诱导/构建逻辑图，找出哪些概念组合会稳定导致某个主题）。

2.	高层特征解耦（Feature Decoupling）：在扩散模型内部（高层表征）把“组合主题的共现特征”从单个概念的正常特征里分离出来，避免“擦组合=误伤组成概念”。  
3.	只擦组合、不伤组件：训练目标是让模型不再激活组合主题，同时尽量保持组成概念各自仍能正常生成（例如 A、B 单独出现时仍正常）。

![image-20260202225012387](./Images/image-20260202225012387.png)

当前 CoGFD方法最大的痛点是：

例如：按照论文给出的效果，当试图消除 "Biden stealing a car"（拜登偷车）时，现有模型往往无法理解“偷窃”是基于两人互动的。为了通过安全测试，模型倾向于直接把 "Biden" 抹除，或者把 "Car" 变成一团噪声。
	本质：模型无法区分 Entity (实体) 与 Relation (关系)。

**1. 核心洞察：**

传统的静态注意力图（CAM）观测往往存在“虚假独立性”，即概念 A（如米老鼠）和概念 B（如吸烟）在空间上看似分离，但实际上存在深层的**因果纠缠**。要解耦它们，不能只看“它们在哪里”，而要看“没有 B 时，A 会如何变化”。

**2. 算法逻辑：**

我们采用一套无需训练的推理阶段干预方案：

- **第一步：因果定位**

  利用控制变量法生成两张图片。在锁定随机种子（Fixed Seed）的前提下，对比“输入 A+B”与“输入 A（屏蔽 B）”时，**主体 A 的注意力图差异**。

  $$Diff = |Map_{Mickey}^{(with\_smoke)} - Map_{Mickey}^{(no\_smoke)}|$$

  该差异图的高亮区域（通常是嘴部），即为隐蔽的**纠缠区域**，据此生成Mask。

- **第二步：注意力切除 **

  在图像生成的关键步数中，利用Mask拦截 Cross-Attention。在Mask区域内，强制将**客体 B（烟）的权重归零**，切断其与主体特定部位的连接。

- **第三步：能量补偿 **

  遵循 Softmax 能量守恒原则，将从 B 处切除的权重，**加回给主体 A（米老鼠）**。这既修复了因权重缺失导致的图像崩坏，又迫使模型调用主体原本的纯净特征来填补空缺。

**3. 预期效果：**

实现**“保留内容但切断交互”**。Prompt 中虽仍有“吸烟”指令，但因最佳生成位置（嘴部）被封锁，模型被迫将烟雾生成在背景、手部或漂浮于空中，从而达成组合概念的**语义解耦**。